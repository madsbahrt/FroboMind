<launch>

<param name="use_sim_time" value="true"/>

<include file="$(find fmCore)/launch/odometry-fusion.launch"></include>
<include file="$(find fmCore)/launch/ASuBot-tf.launch"></include>

<!-- Included here because node was not running when bag was recorded -->
<group ns="fmSensors">
	<node pkg="fmSensors" name="IMU" type="vectornav_imu_node" output="screen"> 
	    <param name="subscribe_topic_id" value="/fmCSP/com0_rx" />
		<param name="publish_topic_id" value="/fmSensors/IMU" />
		<param name="frame_id" value="imu_link" />
		<param name="cov_x" value="0.001"/>
		<param name="cov_y" value="0.001"/>
		<param name="cov_z" value="0.001"/>
	</node>
	
	<node pkg="fmSensors" name="gpgga_parser" type="gps_node" output="screen"> 
	    <param name="subscribe_topic_id" value="/fmCSP/S0_rx" />
		<param name="publish_topic_id" value="/fmSensors/gpgga" />
	</node>
	
</group>

<group ns="viz">
	 <node pkg="rviz" name="visualization" type="rviz" args="-d $(find fmSim)/conf/odom_viz.vcg"/>
	 
	 <node pkg="fmTools" name="imu_marker" type="imu_marker">
	 	<param name="imu_subscriber_topic" value="/fmSensors/IMU"></param>
	 	<param name="marker_publisher_topic" value="/fmTools/imu_marker"></param>
	 	<param name="frame_id" value="base_footprint"></param>
	 </node>
</group>

<!-- Create a transform which moves base footprint back where rviz can see it due to utm coordinates  -->
<node pkg="tf" type="static_transform_publisher" name="utm_link_broadcaster" args="-588797 -6137255 0 0 0 0 map odom_combined 100"/>


</launch>
